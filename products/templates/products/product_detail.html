{% extends "base.html" %}
{% load static %}

{% block extra_title %} - All Dreams {% endblock %}

{% block page_header %}
<div class="container header-container">
    <div class="row">
        <div class="col"></div>
    </div>
</div>
{% endblock %}

{% block body_class %}products-background{% endblock %}
{% block content %}
<!-- <div class="overlay"></div> -->
<div class="container-fluid mt-5">
    <div class="row justify-content-center max-width-500">
        <div class="col-12 mx-auto fade-in-product">
            <!-- Image Section -->
            <div class="my-5">
                {% if product.image %}
                <a href="{{ product.image.url }}" target="_blank">
                    <img class="card-img-top img-fluid product-img-shadow mt-5"
                        src="{{ product.image.url }}"
                        alt="{{ product.name }} Image" style="max-width: 100%;
                        height: auto;">
                </a>
                {% else %}
                <!-- Fallback image if product.image is not available -->
                <a href="">
                    <img class="card-img-top img-fluid mt-5"
                        src="{% static 'sparkling_dreams.webp' %}"
                        alt="Default Image" style="max-width: 100%; height:
                        auto;">
                </a>
                {% endif %}
            </div>
        </div>
        <div class="col-12 max-width-500 mx-auto fade-in-product">
            <!-- Product Details Section -->
            <div class="product-details-container mb-1">
                <h2 class="product-title text-center">
                    {{ product.name }}
                </h2>
                <h3 class="mb2 text-center text-muted small"><i
                        class="fa-solid fa-layer-group"></i>
                    {{ product.category.get_friendly_name }}
                </h3>
                <hr>
                <div class="fade-in-product mt-3">
                    <div class="row align-items-center text-muted text-center">
                        <div class="col">
                            <p class="lead mb-0"><i
                                    class="fa-solid fa-euro-sign muted"></i><br>
                                {{ product.price }}</p>
                        </div>
                        <div class="col text-muted">
                            <p class="lead mb-0">Size:<br>{{ product.size }}
                            </p>
                        </div>
                        <div class="col">
                            {% if product.available %}
                            <span class="text-muted"><i
                                    class="fa-solid fa-check " style="color:
                                    green;"></i><br>Available</span>
                            {% else %}
                            <span class="text-muted"><i
                                    class="fa-solid fa-times"
                                    style="color: red;"></i><br>Not
                                Available</span>
                            {% endif %}
                        </div>
                        <div class="col">
                            <span class="text-muted"><i
                                    class="fa-solid fa-stopwatch fa-2x pr-1"></i>{{ product.duration }}</span>
                        </div>
                    </div>
                    <hr>
                    <p class="text-muted text-center">This realDream can be
                        enjoyed in
                        center(s):</p>
                    <ul class="text-muted dreamcenter-padding">
                        {% for center in product.dream_center.all %}
                        <li>{{ center.name }}</li>
                        {% endfor %}
                    </ul>
                    <p class="p-1 mt-3 product-descr">
                        {{ product.description|linebreaksbr }}
                    </p>
                    <div class="col-12">
                        <form class="form"
                            action="{% url 'add_to_cart' product.id %}"
                            method="POST">
                            {% csrf_token %}
                            <div class="form-row">
                                <div class="col-12">
                                    <p class="mt-3"><strong>Quantity:</strong>
                                    </p>
                                    <div class="form-group w-50">
                                        <div class="input-group">
                                            <input
                                                class="form-control qty_input"
                                                type="number" name="quantity"
                                                value="1" min="1" max="99"
                                                data-item_id="{{ product.id }}"
                                                id="id_qty_{{ product.id }}">
                                        </div>
                                    </div>
                                </div>
                                <hr>
                                <div class="form-row">
                                    <div
                                        class="col-12 d-flex justify-content-center">
                                        <a href="{% url 'products' %}"
                                            class="btn btn-outline-black rounded-2">
                                            <span class="icon">
                                                <i
                                                    class="fas fa-chevron-left"></i>
                                            </span>
                                            <span class="sort-nav-link">Keep
                                                Shopping</span>
                                        </a>
                                        <button type="submit"
                                            class="btn btn-black rounded-2">
                                            <span class="text-uppercase">Add to
                                                cart</span>
                                            <span class="icon">
                                                <i class="fas fa-plus"></i>
                                            </span></button>
                                    </div>
                                </div>
                                <input type="hidden" name="redirect_url"
                                    value="{{ request.path }}">
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endblock %}